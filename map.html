<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="./style.css">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Geolonia with Amazon Location Service</title>
</head>
<body>
  <!-- map container -->
  <div
    id="map"
    data-lat="35.70439"
    data-lng="139.76776"
    data-zoom="15"
    data-marker="off"
    data-style="./style.json"
    data-pitch="0"
    data-hash="on"
    class="left"
  ></div>
  <!-- TODO: スタイル調整が終われば削除する-->
  <pre id="json" class="right"></pre>
  <!-- JavaScript dependencies -->
  <script src="https://cdn.geolonia.com/v1/embed?geolonia-api-key=YOUR-API-KEY"></script>
  <script>
    var provider = new window.geolonia.AmazonLocationServiceMapProvider({
      cognitoIdentityPoolId: "ap-northeast-1:d995db2c-8646-4ed2-8122-45dbd2c80019",
      mapName: 'explore.map' // "test-3d"
    })

    provider
      .initMap({ container: "#map" })
      .then(function(map) {
        /* TODO: 以下はスタイル調整が終わった時削除する */
        map.on('load', () => {
          const dumpFeature = event => {
            const features = map.queryRenderedFeatures(event.point)
            const jsonContainer = document.getElementById('json')
            jsonContainer.innerText = JSON.stringify(features, null, '  ')
          }

          const mouseEnter = () => {
            map.getCanvas().style.cursor = 'pointer'
          }

          const mouseLeave = () => {
            map.getCanvas().style.cursor = ''
          }

          map.getStyle().layers.forEach( (item) => {
            map.on('click', item.id, dumpFeature)
            map.on('mouseenter', item.id, mouseEnter)
            map.on('mouseleave', item.id, mouseLeave)
          })
        })
        /* TODO: ここまで削除する */
      })
  </script>
</body>
</html>